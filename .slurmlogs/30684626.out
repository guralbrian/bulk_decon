Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 12
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	dirichlet
	1

[Tue Feb 13 11:06:08 2024]
rule dirichlet:
    input: data/processed/compositions/whole_samples.csv
    output: data/processed/models/dirichelet_coefficients.csv, results/8_dirichlet/dirichlet_coeff.png
    jobid: 0

Loading required package: tidyverse
── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
Loading required package: DirichletReg
Loading required package: Formula
Loading required package: reshape2

Attaching package: ‘reshape2’

The following object is masked from ‘package:tidyr’:

    smiths

[[1]]
[1] TRUE

[[2]]
[1] TRUE

[[3]]
[1] TRUE

Warning in DR_data(dir.mat[, c(4:length(dir.mat))]) :
  not all rows sum up to 1 => normalization forced
Call:
DirichReg(formula = CellTypes ~ Treatment * Genotype, data = dir.mat, model =
"common")

Standardized Residuals:
                         Min       1Q   Median      3Q     Max
Cardiomyocytes       -1.8328  -0.6562   0.0141  0.4413  1.6271
Endothelial Cells    -2.5397  -0.6949  -0.3912  1.2906  3.2811
Endothelial Cells 2  -1.1672  -0.5986  -0.2750  0.6362  2.4596
Fibroblast           -1.7669  -0.5733  -0.0188  0.1917  1.3344
Macrophages          -1.4737  -0.5778  -0.2478  0.0978  1.7500
SMC                  -1.4342  -0.5536  -0.0926  0.2039  0.7158
VSMC/Pericytes       -0.9636  -0.7244   0.0709  0.5148  3.2388

------------------------------------------------------------------
Beta-Coefficients for variable no. 1: Cardiomyocytes
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               5.8171     0.3019  19.269  < 2e-16 ***
TreatmentTAC             -3.0988     0.4488  -6.904 5.05e-12 ***
GenotypeKO                0.8911     0.4204   2.120    0.034 *  
TreatmentTAC:GenotypeKO  -0.6356     0.6277  -1.013    0.311    
------------------------------------------------------------------
Beta-Coefficients for variable no. 2: Endothelial Cells
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               4.5190     0.3039  14.867   <2e-16 ***
TreatmentTAC             -4.7987     0.5428  -8.841   <2e-16 ***
GenotypeKO                0.9881     0.4224   2.339   0.0193 *  
TreatmentTAC:GenotypeKO  -2.0410     0.7859  -2.597   0.0094 ** 
------------------------------------------------------------------
Beta-Coefficients for variable no. 3: Endothelial Cells 2
                        Estimate Std. Error z value Pr(>|z|)  
(Intercept)              -0.7757     0.4697  -1.651   0.0987 .
TreatmentTAC              0.3726     0.6544   0.569   0.5691  
GenotypeKO                1.2639     0.6154   2.054   0.0400 *
TreatmentTAC:GenotypeKO   0.4998     0.8481   0.589   0.5557  
------------------------------------------------------------------
Beta-Coefficients for variable no. 4: Fibroblast
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               3.9462     0.3061  12.891  < 2e-16 ***
TreatmentTAC             -2.2103     0.4673  -4.730 2.25e-06 ***
GenotypeKO                1.0075     0.4245   2.373   0.0176 *  
TreatmentTAC:GenotypeKO  -0.1521     0.6443  -0.236   0.8134    
------------------------------------------------------------------
Beta-Coefficients for variable no. 5: Macrophages
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               2.9233     0.3146   9.292  < 2e-16 ***
TreatmentTAC             -1.6844     0.4864  -3.463 0.000534 ***
GenotypeKO                1.1005     0.4327   2.543 0.010990 *  
TreatmentTAC:GenotypeKO  -0.2146     0.6642  -0.323 0.746656    
------------------------------------------------------------------
Beta-Coefficients for variable no. 6: SMC
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               1.6342     0.3444   4.745 2.08e-06 ***
TreatmentTAC             -1.5887     0.5529  -2.873  0.00406 ** 
GenotypeKO                1.2252     0.4616   2.654  0.00795 ** 
TreatmentTAC:GenotypeKO   0.1585     0.7288   0.218  0.82779    
------------------------------------------------------------------
Beta-Coefficients for variable no. 7: VSMC/Pericytes
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               3.7905     0.3069  12.349  < 2e-16 ***
TreatmentTAC             -3.3862     0.5142  -6.585 4.54e-11 ***
GenotypeKO                1.0522     0.4253   2.474   0.0134 *  
TreatmentTAC:GenotypeKO  -1.5571     0.7380  -2.110   0.0349 *  
------------------------------------------------------------------
Significance codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Log-likelihood: 298.9 on 28 df (115 BFGS + 1 NR Iterations)
AIC: -541.8, BIC: -520.2
Number of Observations: 16
Link: Log
Parametrization: common
Warning messages:
1: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead. 
2: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead. 
Warning message:
Removed 1 rows containing missing values (`geom_errorbarh()`). 
null device 
          1 
[Tue Feb 13 11:06:31 2024]
Finished job 0.
1 of 1 steps (100%) done
