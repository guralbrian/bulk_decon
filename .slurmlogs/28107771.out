Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	dirichlet
	1

[Fri Jan 19 09:09:48 2024]
rule dirichlet:
    input: data/processed/compositions/whole_samples.csv
    output: data/processed/models/dirichelet_coefficients.csv, results/8_dirichlet/dirichlet_coeff.png
    jobid: 0

Loading required package: tidyverse
── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.3
✔ forcats   0.5.2     ✔ stringr   1.5.0
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
Loading required package: DirichletReg
Loading required package: Formula
Loading required package: reshape2

Attaching package: ‘reshape2’

The following object is masked from ‘package:tidyr’:

    smiths

[[1]]
[1] TRUE

[[2]]
[1] TRUE

[[3]]
[1] TRUE

Warning in DR_data(dir.mat[, c(4:length(dir.mat))]) :
  not all rows sum up to 1 => normalization forced
Call:
DirichReg(formula = CellTypes ~ Treatment * Genotype, data = dir.mat, model =
"common")

Standardized Residuals:
                         Min       1Q   Median       3Q     Max
Cardiomyocytes       -1.8642  -0.3295  -0.0125   0.4996  1.0037
Endothelial Cells    -1.7571  -0.4731  -0.4413  -0.2577  4.5012
Endothelial Cells 2  -1.1401  -0.4317  -0.1846   0.1862  1.0676
Fibroblast           -0.8889  -0.7394  -0.1109   0.5168  1.7566
Macrophages          -1.0507  -0.4465  -0.2717  -0.0302  1.6281
SMC                  -1.1243  -0.6929   0.9050   1.2576  3.9657
VSMC/Pericytes       -1.1511  -0.3420  -0.0412   0.2161  3.5647

------------------------------------------------------------------
Beta-Coefficients for variable no. 1: Cardiomyocytes
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               4.8243     0.3149  15.321   <2e-16 ***
TreatmentTAC             -0.4460     0.4447  -1.003   0.3160    
GenotypeKO               -0.0903     0.4331  -0.208   0.8348    
TreatmentTAC:GenotypeKO  -1.2796     0.6279  -2.038   0.0416 *  
------------------------------------------------------------------
Beta-Coefficients for variable no. 2: Endothelial Cells
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)              -0.4885     0.4589  -1.064 0.287129    
TreatmentTAC             -0.8950     0.6696  -1.337 0.181371    
GenotypeKO                2.7694     0.5598   4.947 7.53e-07 ***
TreatmentTAC:GenotypeKO  -2.9930     0.8903  -3.362 0.000775 ***
------------------------------------------------------------------
Beta-Coefficients for variable no. 3: Endothelial Cells 2
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               2.9976     0.3245   9.237   <2e-16 ***
TreatmentTAC             -0.4144     0.4617  -0.898    0.369    
GenotypeKO               -0.2209     0.4496  -0.491    0.623    
TreatmentTAC:GenotypeKO  -1.0111     0.6666  -1.517    0.129    
------------------------------------------------------------------
Beta-Coefficients for variable no. 4: Fibroblast
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)              2.95100    0.32505   9.079   <2e-16 ***
TreatmentTAC             0.38270    0.45581   0.840    0.401    
GenotypeKO               0.03067    0.44799   0.068    0.945    
TreatmentTAC:GenotypeKO -0.68246    0.64307  -1.061    0.289    
------------------------------------------------------------------
Beta-Coefficients for variable no. 5: Macrophages
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               1.8729     0.3455   5.420 5.95e-08 ***
TreatmentTAC              0.9178     0.4746   1.934   0.0531 .  
GenotypeKO                0.1357     0.4761   0.285   0.7756    
TreatmentTAC:GenotypeKO  -0.7845     0.6707  -1.170   0.2421    
------------------------------------------------------------------
Beta-Coefficients for variable no. 6: SMC
                        Estimate Std. Error z value Pr(>|z|)  
(Intercept)              -0.9908     0.4781  -2.072   0.0382 *
TreatmentTAC              1.2332     0.6360   1.939   0.0525 .
GenotypeKO                1.1520     0.6358   1.812   0.0700 .
TreatmentTAC:GenotypeKO  -0.2234     0.8485  -0.263   0.7924  
------------------------------------------------------------------
Beta-Coefficients for variable no. 7: VSMC/Pericytes
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               3.1215     0.3232   9.657  < 2e-16 ***
TreatmentTAC             -0.8750     0.4653  -1.880  0.06005 .  
GenotypeKO               -0.1393     0.4467  -0.312  0.75511    
TreatmentTAC:GenotypeKO  -2.1472     0.7090  -3.028  0.00246 ** 
------------------------------------------------------------------
Significance codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Log-likelihood: 296.2 on 28 df (118 BFGS + 1 NR Iterations)
AIC: -536.3, BIC: -514.7
Number of Observations: 16
Link: Log
Parametrization: common
Warning messages:
1: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead. 
2: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead. 
Warning message:
Removed 1 rows containing missing values (`geom_errorbarh()`). 
null device 
          1 
[Fri Jan 19 09:09:55 2024]
Finished job 0.
1 of 1 steps (100%) done
