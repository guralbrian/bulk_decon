Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	deconvolute
	1

[Fri Jan 19 09:06:18 2024]
rule deconvolute:
    input: data/processed/single_cell/celltype_labeled.h5seurat, data/raw/rau_fractions/celltype_pheno.csv, data/processed/bulk/jensen_pheno.csv, data/processed/single_cell/cluster_markers.csv, data/processed/bulk/all_counts.csv
    output: data/processed/compositions/whole_samples.csv, data/processed/compositions/fraction_samples.csv
    jobid: 0

── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.3
✔ forcats   0.5.2     ✔ stringr   1.5.0
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
Attaching SeuratObject
Registered S3 method overwritten by 'SeuratDisk':
  method            from  
  as.sparse.H5Group Seurat
---------------------------------------------------------------
SCpubr

If you use SCpubr in your research, please cite it accordingly: 
Blanco-Carmona, E. Generating publication ready visualizations for Single Cell transcriptomics using SCpubr. bioRxiv (2022) doi:10.1101/2022.02.28.482303.

If the package is useful to you, consider leaving a Star in the GitHub repo: https://github.com/enblacar/SCpubr/stargazers 

Keep track of the package updates on Twitter (@Enblacar) or in https://github.com/enblacar/SCpubr/blob/main/NEWS.md 

To suppress this startup message, use: 
suppressPackageStartupMessages(library('SCpubr'))
---------------------------------------------------------------

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:lubridate’:

    intersect, setdiff, union

The following objects are masked from ‘package:dplyr’:

    combine, intersect, setdiff, union

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which.max, which.min

Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘limma’

The following object is masked from ‘package:BiocGenerics’:

    plotMA

Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
MuSiC v1.0.0 support SingleCellExperiment! See Tutorial: https://xuranw.github.io/MuSiC/articles/MuSiC.html
MuSiC2 for multi-condition bulk RNA-seq data is also available!

Attaching package: ‘reshape2’

The following object is masked from ‘package:tidyr’:

    smiths


Attaching package: ‘matrixStats’

The following objects are masked from ‘package:Biobase’:

    anyMissing, rowMedians

The following object is masked from ‘package:dplyr’:

    count


Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

The following object is masked from ‘package:Biobase’:

    rowMedians


Attaching package: ‘S4Vectors’

The following objects are masked from ‘package:lubridate’:

    second, second<-

The following objects are masked from ‘package:dplyr’:

    first, rename

The following object is masked from ‘package:tidyr’:

    expand

The following objects are masked from ‘package:base’:

    expand.grid, I, unname


Attaching package: ‘IRanges’

The following object is masked from ‘package:lubridate’:

    %within%

The following objects are masked from ‘package:dplyr’:

    collapse, desc, slice

The following object is masked from ‘package:purrr’:

    reduce


Attaching package: ‘SummarizedExperiment’

The following object is masked from ‘package:SeuratObject’:

    Assays

The following object is masked from ‘package:Seurat’:

    Assays

[[1]]
[1] TRUE

[[2]]
[1] TRUE

[[3]]
[1] TRUE

[[4]]
[1] TRUE

[[5]]
[1] TRUE

[[6]]
[1] TRUE

[[7]]
[1] TRUE

[[8]]
[1] TRUE

Validating h5Seurat file
Initializing RNA with data
Adding counts for RNA
Adding scale.data for RNA
Adding feature-level metadata for RNA
Adding variable feature information for RNA
Adding miscellaneous information for RNA
Adding reduction harmony
Adding cell embeddings for harmony
Adding miscellaneous information for harmony
Adding reduction pca
Adding cell embeddings for pca
Adding feature loadings for pca
Adding miscellaneous information for pca
Adding reduction umap
Adding cell embeddings for umap
Adding miscellaneous information for umap
Adding command information
Adding cell-level metadata
Adding miscellaneous information
Adding tool-specific results
Creating Relative Abudance Matrix...
Creating Variance Matrix...
Creating Library Size Matrix...
Used 66 common genes...
Used 7 cell types in deconvolution...
WT sham (1) has common genes 66 ...
WT sham (2) has common genes 66 ...
WT sham (3) has common genes 66 ...
WT sham (4) has common genes 66 ...
KO sham (1) has common genes 66 ...
KO sham (2) has common genes 66 ...
KO sham (3) has common genes 66 ...
KO sham (4) has common genes 66 ...
WT MI (1) has common genes 66 ...
WT MI (2) has common genes 66 ...
WT MI (3) has common genes 66 ...
KO MI (1) has common genes 66 ...
KO MI (2) has common genes 66 ...
KO MI (3) has common genes 66 ...
WT MI (4) has common genes 66 ...
KO MI (4) has common genes 66 ...
B6.F.CM.RNA.1 has common genes 66 ...
B6.F.CM.RNA.2 has common genes 66 ...
B6.F.CM.RNA.3 has common genes 66 ...
B6.F.CM.RNA.4 has common genes 66 ...
B6.F.CM.RNA.5 has common genes 66 ...
B6.F.Fib.RNA.1 has common genes 66 ...
B6.F.Fib.RNA.3 has common genes 66 ...
B6.F.Fib.RNA.4 has common genes 66 ...
B6.F.Fib.RNA.5 has common genes 66 ...
B6.M.CM.RNA.1 has common genes 66 ...
B6.M.CM.RNA.3 has common genes 66 ...
B6.M.CM.RNA.4 has common genes 66 ...
B6.M.CM.RNA.5 has common genes 66 ...
B6.M.Fib.RNA.2 has common genes 66 ...
B6.M.Fib.RNA.3 has common genes 66 ...
B6.M.Endo.RNA.1 has common genes 66 ...
B6.M.Endo.RNA.2 has common genes 66 ...
B6.M.Endo.RNA.3 has common genes 65 ...
[Fri Jan 19 09:07:55 2024]
Finished job 0.
1 of 1 steps (100%) done
